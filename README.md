# qaguru-grpc-tests

## Описание

Этот проект содержит автотесты для gRPC-сервиса валют. Тесты покрывают основные сценарии работы сервиса: получение списка валют, расчёт курсов, обработку ошибок и граничных значений.

## Фикстуры

В файле `tests/conftest.py` определены следующие фикстуры:
- **settings** — возвращает объект с настройками для тестов (адреса сервисов).
- **mock** — булева фикстура, определяет, используется ли mock-сервер (управляется аргументом командной строки `--mock`).
- **grpc_client** — создаёт gRPC-клиент с нужными интерцепторами и подключением к реальному или mock-серверу в зависимости от значения `mock`.

## Тесты

В директории `tests` реализованы автотесты для gRPC-сервиса валют:

- **test_get_all_currencies.py** — проверяет получение всех поддерживаемых валют и их курсов.
- **test_calculate_rate.py** — содержит набор тестов для проверки расчёта конвертации валют, в том числе:
  - базовые сценарии расчёта курса
  - параметризованные проверки разных валют и сумм
  - проверки ошибок при отсутствии обязательных параметров (валюта, сумма)
  - проверки некорректных значений (отрицательные суммы, нулевые значения)

## Запуск тестов

1. Создайте и активируйте виртуальное окружение:
   ```bash
   python3 -m venv venv
   source venv/bin/activate
   ```
2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. Запустите тесты:
   ```bash
   pytest tests/
   ```
   Для запуска тестов с использованием mock-сервера добавьте аргумент:
   ```bash
   pytest tests/ --mock
   ```